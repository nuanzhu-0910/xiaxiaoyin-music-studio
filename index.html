<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>夏萧因 - 世界之外</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/vue@2.6.14/dist/vue.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Noto Sans SC', sans-serif;
        }
        
        body {
            background: #0a0a16;
            color: #fff;
            height: 100vh;
            overflow: hidden;
            position: relative;
        }
        
        .top-buttons {
            position: fixed;
            top: 30px;
            right: 30px;
            z-index: 100;
            display: flex;
            gap: 15px;
        }
        
        .login-btn, .music-btn {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 50px;
            padding: 12px 25px;
            color: white;
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }
        
        .login-btn:hover, .music-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        
        .music-btn.playing {
            background: rgba(233, 69, 96, 0.3);
            border-color: rgba(233, 69, 96, 0.5);
        }
        
        .music-btn.playing i {
            color: #e94560;
        }
        
        .carousel-container {
            width: 100%;
            height: 100vh;
            position: relative;
            overflow: hidden;
        }
        
        .carousel-track {
            display: flex;
            width: 500%;
            height: 100%;
            transition: transform 2s ease-in-out;
        }
        
        .carousel-slide {
            width: 20%;
            height: 100%;
            flex-shrink: 0;
            position: relative;
        }
        
        .fullscreen-image {
            width: 100%;
            height: 100%;
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            position: relative;
            display: flex;
            align-items: flex-end;
            justify-content: center;
        }
        
        /* 左上角签名字素样式 */
        .signature-corner {
            position: absolute;
            top: 30px;
            left: 30px;
            z-index: 5;
            width: 120px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0.9;
            filter: drop-shadow(0 0 8px rgba(0, 0, 0, 0.5));
            transition: all 0.5s ease;
        }
        
        .signature-img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
        }
        
        .card-info {
            position: absolute;
            bottom: 80px;
            left: 0;
            width: 100%;
            padding: 0 50px;
            text-align: center;
            background: linear-gradient(transparent, rgba(0, 0, 0, 0.7));
            padding-top: 100px;
            padding-bottom: 30px;
            opacity: 0;
            transform: translateY(50px);
            transition: all 1.5s ease 0.5s;
            z-index: 3;
        }
        
        .carousel-slide.active .card-info {
            opacity: 1;
            transform: translateY(0);
        }
        
        .card-title {
            font-size: 3rem;
            font-weight: 700;
            margin-bottom: 15px;
            text-shadow: 2px 2px 8px rgba(0, 0, 0, 0.8);
            color: #fff;
        }
        
        .card-signature {
            font-size: 1.5rem;
            font-style: italic;
            opacity: 0.9;
            text-shadow: 1px 1px 4px rgba(0, 0, 0, 0.7);
            max-width: 800px;
            margin: 0 auto;
            line-height: 1.6;
        }
        
        .carousel-indicators {
            position: absolute;
            bottom: 30px;
            left: 0;
            width: 100%;
            display: flex;
            justify-content: center;
            gap: 15px;
            z-index: 10;
        }
        
        .indicator {
            width: 14px;
            height: 14px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.4);
            cursor: pointer;
            transition: all 0.5s ease;
        }
        
        .indicator.active {
            background: white;
            transform: scale(1.3);
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
        }
        
        .carousel-nav {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            width: 100%;
            display: flex;
            justify-content: space-between;
            padding: 0 30px;
            z-index: 10;
        }
        
        .nav-btn {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            width: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            cursor: pointer;
            transition: all 0.5s ease;
            font-size: 1.5rem;
        }
        
        .nav-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(1.1);
        }
        
        .login-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.5s ease;
        }
        
        .login-modal.active {
            opacity: 1;
            visibility: visible;
        }
        
        .login-content {
            background: #1a1a2e;
            border-radius: 20px;
            padding: 40px;
            width: 90%;
            max-width: 400px;
            text-align: center;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.5);
            transform: translateY(30px);
            transition: transform 0.5s ease;
            position: relative;
        }
        
        .login-modal.active .login-content {
            transform: translateY(0);
        }
        
        .login-title {
            font-size: 1.8rem;
            margin-bottom: 10px;
            color: #e94560;
        }
        
        .login-subtitle {
            margin-bottom: 30px;
            opacity: 0.8;
        }
        
        .qrcode-container {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            display: inline-block;
        }
        
        .qrcode {
            width: 200px;
            height: 200px;
            background: #f5f5f5;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #333;
            font-size: 0.9rem;
        }
        
        .qrcode img {
            width: 100%;
            height: 100%;
        }
        
        .login-tip {
            font-size: 0.9rem;
            opacity: 0.7;
            margin-top: 20px;
        }
        
        .close-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
        }
        
        .character-name {
            position: absolute;
            top: 30px;
            left: 50px;
            font-size: 2.5rem;
            font-weight: 700;
            z-index: 10;
            text-shadow: 2px 2px 8px rgba(0, 0, 0, 0.5);
        }
        
        .game-title {
            position: absolute;
            top: 85px;
            left: 50px;
            font-size: 1.2rem;
            opacity: 0.8;
            z-index: 10;
        }
        
        .slide-counter {
            position: absolute;
            bottom: 30px;
            right: 50px;
            font-size: 1rem;
            opacity: 0.7;
            z-index: 10;
        }
        
        .auto-play-toggle {
            position: absolute;
            bottom: 30px;
            left: 50px;
            display: flex;
            align-items: center;
            gap: 10px;
            z-index: 10;
            font-size: 0.9rem;
            opacity: 0.7;
            cursor: pointer;
            transition: opacity 0.5s ease;
        }
        
        .auto-play-toggle:hover {
            opacity: 1;
        }
        
        .toggle-switch {
            width: 40px;
            height: 20px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            position: relative;
            transition: background 0.5s ease;
        }
        
        .toggle-switch.active {
            background: #e94560;
        }
        
        .toggle-switch::after {
            content: '';
            position: absolute;
            width: 16px;
            height: 16px;
            background: white;
            border-radius: 50%;
            top: 2px;
            left: 2px;
            transition: transform 0.5s ease;
        }
        
        .toggle-switch.active::after {
            transform: translateX(20px);
        }
        
        .progress-bar {
            position: absolute;
            bottom: 0;
            left: 0;
            height: 3px;
            background: #e94560;
            width: 0%;
            transition: width 0.1s linear;
            z-index: 10;
        }

        /* 音乐播放器样式 */
        .music-player {
            position: fixed;
            bottom: 30px;
            right: 200px;
            z-index: 100;
            display: flex;
            align-items: center;
            gap: 10px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 25px;
            padding: 8px 15px;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.3s ease;
        }
        
        .music-player.show {
            opacity: 1;
            transform: translateY(0);
        }
        
        .music-info {
            font-size: 0.8rem;
            color: rgba(255, 255, 255, 0.8);
        }
        
        .volume-control {
            width: 80px;
            height: 4px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 2px;
            position: relative;
            cursor: pointer;
        }
        
        .volume-level {
            position: absolute;
            height: 100%;
            background: #e94560;
            border-radius: 2px;
            width: 70%;
        }
        
        /* 微信登录相关样式 */
        .login-status {
            margin-top: 20px;
            padding: 10px;
            border-radius: 5px;
            font-size: 0.9rem;
        }
        
        .status-loading {
            background: rgba(255, 193, 7, 0.2);
            color: #ffc107;
        }
        
        .status-success {
            background: rgba(40, 167, 69, 0.2);
            color: #28a745;
        }
        
        .status-error {
            background: rgba(220, 53, 69, 0.2);
            color: #dc3545;
        }
        
        .login-steps {
            text-align: left;
            margin: 20px 0;
            font-size: 0.9rem;
        }
        
        .login-steps li {
            margin: 10px 0;
            opacity: 0.8;
        }
        
        .refresh-btn {
            background: #e94560;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 15px;
            transition: all 0.3s ease;
        }
        
        .refresh-btn:hover {
            background: #d1344e;
            transform: translateY(-2px);
        }
        
        @media (max-width: 768px) {
            .top-buttons {
                top: 20px;
                right: 20px;
                flex-direction: column;
                gap: 10px;
            }
            
            .login-btn, .music-btn {
                padding: 10px 20px;
                font-size: 0.9rem;
            }
            
            .music-player {
                bottom: 80px;
                right: 20px;
            }
            
            .signature-corner {
                width: 80px;
                height: 40px;
                top: 20px;
                left: 20px;
            }
        }
    </style>
</head>
<body>
    <div id="app">
        <!-- 顶部按钮组 -->
        <div class="top-buttons">
            <button class="music-btn" :class="{ playing: isMusicPlaying }" @click="toggleMusic">
                <i class="fas fa-music"></i>
                <span>{{ isMusicPlaying ? '暂停音乐' : '播放音乐' }}</span>
            </button>
            <button class="login-btn" @click="showLoginModal">
                <i class="fab fa-weixin"></i>
                微信登录
            </button>
        </div>
        
        <!-- 音乐播放器 -->
        <div class="music-player" :class="{ show: isMusicPlaying }">
            <div class="music-info">背景音乐</div>
            <div class="volume-control" @click="setVolume">
                <div class="volume-level" :style="{ width: (volume * 100) + '%' }"></div>
            </div>
        </div>
        
        <div class="carousel-container">
            <div class="progress-bar" :style="{ width: progressWidth + '%' }"></div>
            
            <div class="carousel-track" :style="{ transform: 'translateX(-' + (currentSlide * 20) + '%)' }">
                <!-- 循环渲染轮播图 -->
                <div class="carousel-slide" v-for="(slide, index) in slides" :key="index" :class="{ active: currentSlide === index }">
                    <div class="fullscreen-image" :style="{ backgroundImage: 'url(' + slide.image + ')' }">
                        <!-- 左上角签名字素 -->
                        <div class="signature-corner">
                            <img :src="slide.signatureImg" :alt="slide.title + '签名'" class="signature-img">
                        </div>
                        <div class="card-info">
                            <div class="card-title">{{ slide.title }}</div>
                            <div class="card-signature">"{{ slide.quote }}"</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="carousel-nav">
                <div class="nav-btn prev-btn" @click="prevSlide">
                    <i class="fas fa-chevron-left"></i>
                </div>
                <div class="nav-btn next-btn" @click="nextSlide">
                    <i class="fas fa-chevron-right"></i>
                </div>
            </div>
            
            <div class="carousel-indicators">
                <div class="indicator" 
                     v-for="(slide, index) in slides" 
                     :key="index" 
                     :class="{ active: currentSlide === index }"
                     @click="goToSlide(index)">
                </div>
            </div>
            
            <div class="slide-counter">
                <span>{{ currentSlide + 1 }}</span> / <span>{{ slides.length }}</span>
            </div>
            
            <div class="auto-play-toggle" @click="toggleAutoPlay">
                <div class="toggle-switch" :class="{ active: isAutoPlay }"></div>
                <span>自动播放</span>
            </div>
        </div>
        
        <!-- 登录模态框 -->
        <div class="login-modal" :class="{ active: showModal }" @click="closeModal">
            <div class="login-content" @click.stop>
                <button class="close-btn" @click="closeModal">
                    <i class="fas fa-times"></i>
                </button>
                <h2 class="login-title">微信登录</h2>
                <p class="login-subtitle">扫描二维码登录您的账号</p>
                
                <div class="qrcode-container">
                    <div class="qrcode" id="qrcode">
                        <div v-if="!qrcodeGenerated" style="text-align: center; padding: 20px;">
                            <i class="fab fa-weixin" style="font-size: 3rem; color: #07c160; margin-bottom: 10px;"></i>
                            <div>正在生成二维码...</div>
                        </div>
                    </div>
                </div>
                
                <div class="login-status" :class="statusClass" v-if="loginStatus">
                    {{ loginStatus }}
                </div>
                
                <ul class="login-steps" v-if="!isLoggedIn">
                    <li><i class="fas fa-mobile-alt"></i> 打开手机微信</li>
                    <li><i class="fas fa-qrcode"></i> 点击扫一扫</li>
                    <li><i class="fas fa-camera"></i> 扫描上方二维码</li>
                </ul>
                
                <button class="refresh-btn" @click="generateQRCode" v-if="!isLoggedIn">
                    <i class="fas fa-sync-alt"></i> 刷新二维码
                </button>
                
                <div v-if="isLoggedIn" style="margin-top: 20px;">
                    <p style="color: #28a745; font-weight: bold;">
                        <i class="fas fa-check-circle"></i> 登录成功！
                    </p>
                    <p style="margin-top: 10px; opacity: 0.8;">
                        欢迎回来，{{ userInfo.nickname }}
                    </p>
                </div>
                
                <p class="login-tip">登录后即可收藏卡面、同步游戏进度</p>
            </div>
        </div>

        <!-- 音频元素 -->
        <audio id="backgroundMusic" loop>
            <!-- 这里可以替换为您自己的音乐文件 -->
            <source src="./huahaoyueyuan.mp3" type="audio/mpeg">
            您的浏览器不支持音频元素。
        </audio>
    </div>

    <script>
        new Vue({
            el: '#app',
            data: {
                currentSlide: 0,
                slides: [
                    {
                        image: './linbie.jpg',
                        title: '临别',
                        signatureImg: './character-logo.jpg',
                        quote: '要记住，这场戏是你先开始演的。'
                    },
                    {
                        image: './zhiwoanyong.jpg',
                        title: '知我暗涌',
                        signatureImg: './character-logo.jpg',
                        quote: '你要记住，我可是怪物。'
                    },
                    {
                        image: './moon.jpg',
                        title: '月上黄泉',
                        signatureImg: './character-logo.jpg',
                        quote: '要记住，我们是彼此唯一的舞伴'
                    },
                    {
                        image: 'images/card4.jpg',
                        title: '请输入文本',
                        signatureImg: './character-logo.jpg',
                        quote: '请输入文本'
                    },
                    {
                        image: 'images/card5.jpg',
                        title: '请输入文本',
                        signatureImg: './character-logo.jpg',
                        quote: '请输入文本'
                    }
                ],
                isAutoPlay: true,
                progressWidth: 0,
                progressInterval: null,
                autoSlideInterval: null,
                showModal: false,
                isMusicPlaying: false,
                volume: 0.7,
                slideDuration: 5000,
                // 微信登录相关数据
                qrcodeGenerated: false,
                loginStatus: '',
                isLoggedIn: false,
                userInfo: {
                    nickname: '',
                    avatar: ''
                },
                checkInterval: null
            },
            computed: {
                statusClass() {
                    if (this.loginStatus.includes('成功')) {
                        return 'status-success';
                    } else if (this.loginStatus.includes('失败') || this.loginStatus.includes('过期')) {
                        return 'status-error';
                    } else if (this.loginStatus.includes('扫描')) {
                        return 'status-loading';
                    }
                    return '';
                }
            },
            mounted() {
                this.startAutoSlide();
                this.backgroundMusic = document.getElementById('backgroundMusic');
                this.backgroundMusic.volume = this.volume;
                
                // 添加键盘事件监听
                document.addEventListener('keydown', this.handleKeydown);
            },
            beforeDestroy() {
                // 清理定时器
                clearInterval(this.autoSlideInterval);
                clearInterval(this.progressInterval);
                this.clearLoginInterval();
                
                // 移除事件监听
                document.removeEventListener('keydown', this.handleKeydown);
            },
            methods: {
                nextSlide() {
                    this.stopAutoSlide();
                    this.currentSlide = (this.currentSlide + 1) % this.slides.length;
                    this.startAutoSlide();
                },
                prevSlide() {
                    this.stopAutoSlide();
                    this.currentSlide = (this.currentSlide - 1 + this.slides.length) % this.slides.length;
                    this.startAutoSlide();
                },
                goToSlide(index) {
                    this.stopAutoSlide();
                    this.currentSlide = index;
                    this.startAutoSlide();
                },
                startAutoSlide() {
                    if (this.isAutoPlay) {
                        this.autoSlideInterval = setInterval(this.nextSlide, this.slideDuration);
                        this.resetProgressBar();
                    }
                },
                stopAutoSlide() {
                    clearInterval(this.autoSlideInterval);
                    clearInterval(this.progressInterval);
                    this.progressWidth = 0;
                },
                resetProgressBar() {
                    this.progressWidth = 0;
                    clearInterval(this.progressInterval);
                    
                    if (this.isAutoPlay) {
                        let width = 0;
                        this.progressInterval = setInterval(() => {
                            if (width >= 100) {
                                clearInterval(this.progressInterval);
                            } else {
                                width += 0.2;
                                this.progressWidth = width;
                            }
                        }, this.slideDuration / 500);
                    }
                },
                toggleAutoPlay() {
                    this.isAutoPlay = !this.isAutoPlay;
                    
                    if (this.isAutoPlay) {
                        this.startAutoSlide();
                    } else {
                        this.stopAutoSlide();
                    }
                },
                showLoginModal() {
                    this.showModal = true;
                    this.generateQRCode();
                },
                closeModal() {
                    this.showModal = false;
                    this.clearLoginInterval();
                    this.resetLoginState();
                },
                toggleMusic() {
                    if (this.isMusicPlaying) {
                        this.backgroundMusic.pause();
                    } else {
                        this.backgroundMusic.play().catch(e => {
                            console.log('音频播放失败:', e);
                            alert('请点击页面任意位置后，再点击播放音乐按钮');
                        });
                    }
                    this.isMusicPlaying = !this.isMusicPlaying;
                },
                setVolume(event) {
                    const rect = event.currentTarget.getBoundingClientRect();
                    const clickX = event.clientX - rect.left;
                    this.volume = Math.max(0, Math.min(1, clickX / rect.width));
                    this.backgroundMusic.volume = this.volume;
                },
                handleKeydown(event) {
                    if (event.key === 'Escape') {
                        this.closeModal();
                    } else if (event.key === 'ArrowLeft') {
                        this.stopAutoSlide();
                        this.prevSlide();
                        this.startAutoSlide();
                    } else if (event.key === 'ArrowRight') {
                        this.stopAutoSlide();
                        this.nextSlide();
                        this.startAutoSlide();
                    } else if (event.key === ' ') {
                        this.toggleAutoPlay();
                    } else if (event.key === 'm' || event.key === 'M') {
                        this.toggleMusic();
                    }
                },
                // 微信登录相关方法
                generateQRCode() {
                    // 在实际项目中，这里应该调用后端API获取微信登录二维码
                    this.loginStatus = '正在生成二维码...';
                    this.qrcodeGenerated = false;
                    
                    // 模拟生成二维码的过程
                    setTimeout(() => {
                        const qrcodeElement = document.getElementById('qrcode');
                        qrcodeElement.innerHTML = '';
                        
                        // 生成一个模拟的登录URL（实际项目中应该是后端返回的微信登录URL）
                        const loginUrl = 'https://open.weixin.qq.com/connect/qrconnect?appid=YOUR_APPID&redirect_uri=YOUR_REDIRECT_URI&response_type=code&scope=snsapi_login&state=STATE#wechat_redirect';
                        
                        // 使用QRCode.js生成二维码
                        QRCode.toCanvas(qrcodeElement, loginUrl, {
                            width: 200,
                            height: 200,
                            colorDark: '#000000',
                            colorLight: '#ffffff',
                            correctLevel: QRCode.CorrectLevel.H
                        }, (error) => {
                            if (error) {
                                console.error('二维码生成失败:', error);
                                this.loginStatus = '二维码生成失败，请重试';
                                return;
                            }
                            
                            this.qrcodeGenerated = true;
                            this.loginStatus = '请使用微信扫描二维码';
                            this.startCheckingLoginStatus();
                        });
                    }, 1000);
                },
                startCheckingLoginStatus() {
                    // 清除之前的检查间隔
                    this.clearLoginInterval();
                    
                    // 开始检查登录状态（实际项目中应该轮询后端API）
                    this.checkInterval = setInterval(() => {
                        // 模拟登录状态检查
                        const status = Math.random();
                        
                        if (status < 0.3) {
                            // 30% 概率模拟扫描成功
                            this.loginStatus = '扫描成功，请在手机上确认登录';
                        } else if (status < 0.6) {
                            // 30% 概率模拟登录成功
                            this.simulateLoginSuccess();
                        } else if (status < 0.9) {
                            // 30% 概率保持等待状态
                            // 保持当前状态
                        } else {
                            // 10% 概率模拟二维码过期
                            this.loginStatus = '二维码已过期，请刷新';
                            this.clearLoginInterval();
                        }
                    }, 2000);
                },
                simulateLoginSuccess() {
                    this.loginStatus = '登录成功！';
                    this.isLoggedIn = true;
                    this.userInfo = {
                        nickname: '夏萧因的粉丝',
                        avatar: ''
                    };
                    this.clearLoginInterval();
                    
                    // 在实际项目中，这里应该处理登录成功后的逻辑
                    // 比如获取用户信息、设置登录状态等
                    console.log('微信登录成功');
                    
                    // 3秒后自动关闭登录模态框
                    setTimeout(() => {
                        this.closeModal();
                    }, 3000);
                },
                clearLoginInterval() {
                    if (this.checkInterval) {
                        clearInterval(this.checkInterval);
                        this.checkInterval = null;
                    }
                },
                resetLoginState() {
                    this.loginStatus = '';
                    this.isLoggedIn = false;
                    this.userInfo = {
                        nickname: '',
                        avatar: ''
                    };
                    this.qrcodeGenerated = false;
                }
            }
        });
    </script>
</body>
</html>